<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>حاسبة التداول</title>

<!-- أيقونة للتطبيق على الهاتف -->
<link rel="apple-touch-icon" href="math.png" />
<link rel="icon" type="image/png" sizes="192x192" href="math.png" />

<style>
  body {
    font-family: Arial, sans-serif;
    direction: rtl;
    padding: 15px;
    max-width: 480px;
    margin: auto;
    background: #f0f4f8;
  }
  h1 {
    text-align: center;
    color: #1e88e5;
  }
  label {
    font-weight: bold;
    display: block;
    margin: 10px 0 5px;
  }
  input, select, button {
    width: 100%;
    padding: 10px;
    font-size: 1.1em;
    border-radius: 6px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  button {
    margin-top: 15px;
    background-color: #1e88e5;
    color: white;
    cursor: pointer;
    border: none;
    font-weight: bold;
  }
  button:hover {
    background-color: #1565c0;
  }
  .result, .percentage {
    margin-top: 20px;
    padding: 15px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 0 10px #bbb;
  }
  .result p, .percentage p {
    font-size: 1.2em;
    margin: 8px 0;
  }
</style>
</head>
<body>

<h1>حاسبة التداول</h1>

<label for="totalPoints">عدد النقاط الكلي المحتمل خسارته</label>
<input type="number" id="totalPoints" min="0" step="1" />

<label for="lotSize">حجم الصفقة (لوت)</label>
<input type="number" id="lotSize" min="0" step="0.01" />

<label for="pairSelect">اختر الزوج</label>
<select id="pairSelect">
  <option value="gold">الذهب</option>
  <option value="silver">الفضة</option>
  <option value="eurusd" selected>اليورو دولار</option>
  <option value="gbpusd">الباوند دولار</option>
  <option value="usdchf">الدولار فرنك</option>
  <option value="usdjpy">الدولار ين</option>
  <option value="usdcad">الدولار كندي</option>
  <option value="audusd">الأسترالي دولار</option>
  <option value="nzdusd">النيوزيلندي دولار</option>
</select>

<button onclick="calculate()">احسب</button>

<div class="result" id="result"></div>
<div class="percentage" id="percentage"></div>

<script>
  const pointValues = {
    gold: 0.1,
    silver: 0.01,
    eurusd: 10,
    gbpusd: 10,
    usdchf: 10,
    usdjpy: 1000,
    usdcad: 10,
    audusd: 10,
    nzdusd: 10,
  };

  function formatNumber(num) {
    // لو العدد صحيح نرجع بدون فواصل عشرية
    if (Number.isInteger(num)) return num;
    // اذا فيه كسور عشرية نرجع ب2 خانة فقط
    return num.toFixed(2);
  }

  function calculate() {
    const totalPoints = Number(document.getElementById('totalPoints').value);
    const lotSize = Number(document.getElementById('lotSize').value);
    const pair = document.getElementById('pairSelect').value;
    const pointValue = pointValues[pair] || 10;

    if (totalPoints <= 0 || lotSize <= 0) {
      alert("يرجى إدخال قيم صحيحة أكبر من صفر");
      return;
    }

    // حساب خسائر الصفقات 1-3
    const trade1LossPoints = totalPoints;
    const trade2LossPoints = totalPoints - 10;
    const trade3LossPoints = totalPoints / 2;

    // شرط تفعيل الصفقة الرابعة (نصف المسافة >= 15)
    const halfPoints = totalPoints / 2;
    let trade4LossPoints = 0;
    let trade4Active = false;
    if (halfPoints >= 15) {
      trade4LossPoints = 10;
      trade4Active = true;
    }

    // خسائر الصفقات
    const trade1Loss = lotSize * trade1LossPoints * pointValue;
    const trade2Loss = lotSize * trade2LossPoints * pointValue;
    const trade3Loss = lotSize * trade3LossPoints * pointValue;
    const trade4Loss = trade4Active ? lotSize * trade4LossPoints * pointValue : 0;

    const totalLoss = trade1Loss + trade2Loss + trade3Loss + trade4Loss;

    // أرباح الصفقات في التصحيح
    // صفقة 1: ربح 0
    // صفقة 2: ربح 10 نقاط
    // صفقة 3: ربح نصف عدد النقاط
    // صفقة 4: ربح عدد النقاط الكلي - 10 (إذا مفعلة)
    const trade1Profit = 0;
    const trade2Profit = lotSize * 10 * pointValue;
    const trade3Profit = lotSize * (totalPoints / 2) * pointValue;
    const trade4Profit = trade4Active ? lotSize * (totalPoints - 10) * pointValue : 0;

    const totalProfit = trade1Profit + trade2Profit + trade3Profit + trade4Profit;

    // نسبة الربح إلى الخسارة
    const profitLossRatio = (totalProfit / totalLoss) * 100;

    // عرض النتائج مع حذف الأصفار بعد الفاصلة لو العدد صحيح
    const res = `
      <p>صفقة 1 خسارة: $${formatNumber(trade1Loss)}</p>
      <p>صفقة 2 خسارة: $${formatNumber(trade2Loss)}</p>
      <p>صفقة 3 خسارة: $${formatNumber(trade3Loss)}</p>
      ${trade4Active ? `<p>صفقة 4 خسارة: $${formatNumber(trade4Loss)}</p>` : ''}
      <hr>
      <p>مجموع الخسائر: $${formatNumber(totalLoss)}</p>
      <hr>
      <p>صفقة 1 ربح: $${formatNumber(trade1Profit)}</p>
      <p>صفقة 2 ربح: $${formatNumber(trade2Profit)}</p>
      <p>صفقة 3 ربح: $${formatNumber(trade3Profit)}</p>
      ${trade4Active ? `<p>صفقة 4 ربح: $${formatNumber(trade4Profit)}</p>` : ''}
      <hr>
      <p>مجموع الأرباح: $${formatNumber(totalProfit)}</p>
      <hr>
      <p>نسبة الربح إلى الخسارة: ${formatNumber(profitLossRatio)}%</p>
    `;
    document.getElementById('result').innerHTML = res;
  }
</script>

</body>
</html>
